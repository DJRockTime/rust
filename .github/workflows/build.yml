name: Build and Release
on: [push, workflow_dispatch] # 支持手动触发

jobs:
  build:
    runs-on: windows-latest # 使用 GitHub 托管的 Windows 环境
    steps:
      - uses: actions/checkout@v4
      - name: Install Rust
        run: rustup update stable # 自动获取最新的稳定版
      - name: Build Binary
        run: cargo build --release
      - name: Upload to Release
        uses: softprops/action-gh-release@v2 # 自动创建 Release 并上传
        if: startsWith(github.ref, 'refs/tags/') # 仅在打标签时发布
        with:
          files: target/release/*.exe # 自动抓取生成的 exe
        env:
          GITHUB_TOKEN: ${{ secrets.GITHUB_TOKEN }}
